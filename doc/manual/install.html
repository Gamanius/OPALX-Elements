<!-- install.html : tail end of POOMA II tutorials -->
<!-- $Id: install.html,v 1.10 1998/10/26 13:58:03 gvwilson Exp $ -->

<html>
<head>
<title>POOMA&nbsp;II Tutorials: Installation and Use</title>
</head>
<body background="back.gif">

<H1><CENTER><IMG SRC="banner.gif" WIDTH=550 HEIGHT=100
X-SAS-UseImageWidth X-SAS-UseImageHeight ALIGN=bottom></CENTER></H1>

<center><h1>POOMA&nbsp;II Tutorials<br>Installation and Use</h1></center>

<p><b>Contents:</b>
<br>&nbsp;&nbsp;&nbsp;&nbsp;<a href="#install-configure">Installing and Configuring POOMA&nbsp;II</a>
<br>&nbsp;&nbsp;&nbsp;&nbsp;<a href="#pooma-options">Object-Based Initialization</a>

<!---------------------------------------------------------------------->
<a name="install-configure"><h2>Installing and Configuring POOMA&nbsp;II</h2></a>

<p>The POOMA&nbsp;II build system can handle several different
configurations at once; this allows developers to building
<tt>libpooma.a</tt> and POOMA&nbsp;II applications for several
configurations at the same time.  Each configuration is referred to as
a <em>suite</em>, and is described by a <em>suite file</em>.  This is
the main file that the configuration script described below sets up
when it runs.

<p><em>Note:</em> this configuration script is presently available
only for Unix platforms.  Programmers who are installing POOMA&nbsp;II
on the Apple Macintosh, or under Microsoft Windows will need to change
<tt>#define</tt> definitions manually.  Under CodeWarrior, on both
Macintosh and Windows, these definitions are in the file:

<pre><blockquote>
pooma-2.0/src/arch/Metrowerks/Pooma.prefix.h
</blockquote></pre>

<p>If the Intel VCASE C++ compiler is being used with Microsoft
Developer Studio on Windows, the definitions that need to be changed
are in:

<pre><blockquote>
pooma-2.0/src/arch/MS_VisualCPP_5_0/PoomaConfigurations.h
</blockquote></pre>

<p>In addition, when the configuration script is run to set up a new
suite, it will go through all the subdirectories and create a
directory called <tt>&lt;suite&gt;</tt> in each subdirectory that
contains files that will be compiled (where <tt>&lt;suite&gt;</tt> is
the name of the suite).  As described below, the environment variable
<tt>SUITE</tt> must be set to the value of the suite to compile after
the configuration script is run.

<p>The POOMA&nbsp;II configuration script is located in the top level
of the POOMA&nbsp;II distribution tree, and is called
<tt>configure</tt>.  It is written in Perl, and does the following;

<ul>

<li>Creates a suite file called <tt>config/&lt;suite&gt;.suite.mk</tt>
(where <tt>&lt;suite&gt;</tt> is the actual name of the suite) that
has settings for building POOMA&nbsp;II.  The suite file is included
by the other makefiles in POOMA&nbsp;II to get names of, and arguments
for, the compiler and linker.  After a suite file has been generated
using <tt>configure</tt>, developers set the environment variable
<tt>SUITE</tt> to the name of that suite, and run make.

<li>Creates a library build directory called
<tt>lib/&lt;suite&gt;</tt>, and puts several files in it:
	<ul>
	<li>a makefile
	<li>a "stub" makefile, for use in installation
	<li>a <tt>PoomaConfiguration.h</tt> file, with
	<tt>#define</tt> statements indicating how to build
	POOMA&nbsp;II.  Almost all <tt>#defines</tt> take one of the
	following forms:
<pre>
#define SOME_POOMA_VARIABLE    POOMA_YES
#define ANOTHER_POOMA_VARIABLE POOMA_NO
</pre>
	</ul>

<li>Does other small setup tasks so that POOMA&nbsp;II can be built
with a new suite.

</ul>

<p>The most useful <a name="configure-arguments">arguments</a> for
<tt>configure</tt> are:

<dl>

<dt><tt>--arch &lt;arch&gt;</tt></dt>
<dd>Specify an architecture to configure for.  The directory
<tt>config/arch</tt> has several files with <tt>.conf</tt> extensions,
one for each combination of machine and compiler that the current
version of POOMA&nbsp;II supports.  The recommended procedure is to
select an architecture file, edit it if necessary, and then run
<tt>configure&nbsp;--arch&nbsp;&lt;arch&gt;</tt> (plus any other
options) from the top directory of the POOMA&nbsp;II distribution.
If the <tt>SUITE</tt> environment variable is set, and you do not
use the <tt>--arch</tt> flag, the value of <tt>SUITE</tt> will be used
instead.  One or the other of these methods must be used to specify
the desired suite.

<dt><tt>--suite <suite></tt></dd>
<dd>Specify the name of the suite file and <tt>lib/&lt;suite&gt;</tt> build
directory to create.  This can be different than <tt>&lt;arch&gt;</tt>, but if
you do not give the <tt>--suite</tt> option, <tt>&lt;arch&gt;</tt> will be
used. If the <tt>--suite</tt> flag is not given then:
	<ul>
	<li>if <tt>SUITE</tt> is set, that will be used for <tt>&lt;suite&gt;</tt>
	<li>if <tt>SUITE</tt> is not set, <tt>&lt;arch&gt;</tt> will be used.
	</ul>
</dd>

<dt><tt>--prefix &lt;installdir&gt;</tt></dt>
<dd>This selects where to install POOMA&nbsp;II after you have built
the library.  The <tt>INSTALL</tt> file (located in the root directory
of the POOMA&nbsp;II distribution, along with the <tt>LICENSE</tt>
file) describes the directory tree that gets created during
installation.
</dd>

<dt><tt>--opt</tt> or </tt>--debug</tt></dt>
<dd>Select whether to build optimized or debug library by
default.</dd>

<dt><tt>--preinst</tt> or </tt>--nopreinst</tt></dt>
<dd>If <tt>--preinst</tt> is used, the library will pre-instantiate
versions of several classes for several types and dimensions.  This
step is not necessary; the library will build more quickly if you do
not use it, but applications may build more quickly.
</dd>

<dt><tt>--ex</tt> or </tt>--noex</tt></dt>
<dd>Enable or disable exception handling.  Some compilers produce more
efficient code and compile faster when exceptions are turned off.
</dd>

<dt><tt>--parallel</tt> or <tt>--serial</tt></dt>
<dd>These flags determine whether POOMA&nbsp;II will use SMARTS or
not.  If <tt>--parallel</tt> is given, the SMARTS header files will be
included and parallel evaluation will be done.  Otherwise, all
operations will run in serial.

<br>SMARTS is the thread and dataflow package that POOMA&nbsp;II uses
for the multithreaded operation.  It was also developed at the
Advanced Computing Laboratory, and is available on the same CD-ROM as
POOMA&nbsp;II.  This release of SMARTS only runs on Unix platforms;
in order to use SMARTS with POOMA&nbsp;II, you must:
<ul>
<li>compile and install SMARTS before compiling POOMA&nbsp;II; and
<li>set the <tt>SMARTSDIR</tt> environment variable to the
installation directory for SMARTS after installing SMARTS, but before
running POOMA&nbsp;II's <tt>configure</tt> script.
</ul>
</dd>

<dt><tt>--v</tt></dt>
<dd>This flag causes compilers and linkers to print very verbose
output.
</dd>

</dl>

<p>The <a href="tut-4.html#operation-mode-table">mode table</a> in the
last tutorial summarizes the modes produced by different combinations
of configuration flags.

<p>The <tt>configure</tt> scripts also has options that will add extra
<tt>-I</tt>, <tt>-D</tt>, <tt>-L</tt> and other flags to your
compilations.  Run <tt>configure&nbsp;-h</tt> to see a complete list
of options.

<p>After running <tt>configure</tt> and creating a suite file, set the
environment variable <tt>SUITE</tt> to the name of the suite, and run
make.  There is a makefile at the top level of the POOMA&nbsp;II
distribution, and in the <tt>lib/&lt;suite&gt;</tt> directory.  When
make is finished, there should be a
<tt>lib/&lt;suite&gt;/libpooma.a</tt> library file.

<p>This file can be used in one of two ways.  Programmers who are
extending POOMA&nbsp;II can use <tt>libpooma.a</tt> without any other
work, since the library may need to be recompiled often.  Such
developers can build the programs in the <tt>benchmarks</tt> and
<tt>examples</tt> directories (such as <tt>examples/Doof2d</tt>) by
running make in those directories.

<p>Programmers who are just using the library will have to install it.
Typing <tt>make&nbsp;install</tt> will install <tt>libpooma.a</tt> and
the necessary source files in the <tt>&lt;installdir&gt;</tt>
directory (specified with the <tt>--prefix</tt> flag to
<tt>configure</tt>).  Users should then set the environment variable
<tt>POOMADIR</tt> to <tt>&lt;installdir&gt;</tt>, and
<tt>POOMAARCH</tt> to a string indicating the type of build
architecture.  This is <em>not</em> the same as the
<tt>&lt;arch&gt;</tt> name used for configure, but is instead just a
string indicating the type of machine, and for this release may be one
of <tt>sgi64</tt>, <tt>sgin32</tt>, <tt>sgi32</tt>, or <tt>linux</tt>.

<p>After doing all of this, users can go into any subdirectory under
<tt>examples</tt> or <tt>benchmarks</tt> and run:

<blockquote><pre>
make -f Makefile.user
</pre></blockquote>

<p><tt>Makefile.user</tt> first includes a "stub" makefile from the
directory where <tt>libpooma.a</tt> is installed.  This stub makefile
contains settings such as <tt>POOMA_INCLUDES</tt> that are needed to
build POOMA&nbsp;II applications.  For example, the
<tt>Makefile.user</tt> file in <tt>examples/Doof2d</tt> contains the
following:

<blockquote><pre>
### include the POOMA makefile stub, to get compiler flags and libraries
include $(POOMADIR)/$(POOMAARCH)/lib/Makefile.pooma

### the name of the example code to compile
EXAMPLE = Doof2d

### the main target for this makefile
$(EXAMPLE): $(EXAMPLE).cpp
        $(POOMA_CXX) $(POOMA_CXX_DBG_ARGS) -o $(EXAMPLE) $(EXAMPLE).cpp
$(POOMA_INCLUDES) $(POOMA_DEFINES) $(POOMA_LIBS)
</blockquote></pre>

<!---------------------------------------------------------------------->
<a name="pooma-options"><h2>Object-Based Initialization</h2></a>

<p>As mentioned in the <a href="tut-1.html#pooma">first tutorial</a>,
POOMA&nbsp;II can be initialized by passing <tt>argc</tt> and
<tt>argv</tt> to <tt>Pooma::initialize()</tt>, or by creating an
instance of <tt>Pooma::Options</tt>, configuring it, and then
passing that options object to <tt>Pooma::initialize()</tt>.
Thus, instead of using:

<blockquote><pre>
Pooma::initialize(argc, argv);
</pre></blockquote>

<p>a program can do the following:

<blockquote><pre>
Pooma::Options opts;                    // <em>create the options object</em>
opts.concurrency(8);                    // <em>tell Pooma to use 8 threads</em>
opts.logfile("pooma.log");              // <em>turn on output logging</em>
Pooma::initialize(opts);                // <em>initialize Pooma</em>
</pre></blockquote>

<p>These two methods can be combined, which allows a program to
override any options the user might have specified:

<blockquote><pre>
Pooma::Options opts(argc, argv);        // <em>parse command line</em>
opts.concurrency(8);                    // <em>but always use 8 threads</em>
Pooma::initialize(opts);                // <em>actual initialization</em>
</pre></blockquote>

<p>For more information on the configuration options available to
POOMA&nbsp;II programs, please see the POOMA&nbsp;II documentation.

<br>
<br>
<center>
<table>
<tr>	<td><a href="compilers.html">[Prev]</a>
	<td><a href="index.html">[Home]</a>
	<td><a href="errors.html">[Next]</a>
	</tr>
</table>
</center>

</body>
</html>
