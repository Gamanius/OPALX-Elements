OPTION, PSDUMPFREQ = 1;   // 6d data written every 300000 time steps (h5).
OPTION, STATDUMPFREQ = 1;  // Beam Stats written every 10 time steps (stat).
OPTION, BOUNDPDESTROYFQ=10; // Delete lost particles, if any
OPTION, AUTOPHASE=4;        // Autophase is on, and phase of max energy
                            // gain will be found automatically for cavities
Option, VERSION=10900;

Title, string="Solenoid-1 test";

//----------------------------------------------------------------------------
//Global Parameters

REAL rf_freq             = 1.3e3;     //RF frequency. (Hz)
REAL n_particles         = 10000;      //Number of particles in simulation.
REAL beam_bunch_charge   = 1.6021766339999998e-15;      //Charge of bunch. (C)

//Initial Momentum Calculation
REAL Edes    = 1e-3;  // initial energy in GeV
REAL gamma   = (Edes+EMASS)/EMASS;
REAL beta    = sqrt(1-(1/gamma^2));
REAL P0      = gamma*beta*EMASS;    //inital z momentum

//Printing initial energy and momentum to terminal output.
value , {Edes, P0, OPALVERSION};

FOCUS_POLE_0  : MULTIPOLE, L=0.0025, ELEMEDGE=0.000, KN={0, 25};
FIRST_DRIFT_0 : DRIFT    , L=0.025, ELEMEDGE=0.003;
DEFOCUS_POLE_0: MULTIPOLE, L=0.0025, ELEMEDGE=0.028, KN={0, -25};
SECOND_DRIFT_0: DRIFT    , L=0.025, ELEMEDGE=0.030;

FOCUS_POLE_1  : MULTIPOLE, L=0.0025, ELEMEDGE=0.055, KN={0, 25};
FIRST_DRIFT_1 : DRIFT    , L=0.025, ELEMEDGE=0.058;
DEFOCUS_POLE_1: MULTIPOLE, L=0.0025, ELEMEDGE=0.083, KN={0, -25};
SECOND_DRIFT_1: DRIFT    , L=0.025, ELEMEDGE=0.085;

FOCUS_POLE_2  : MULTIPOLE, L=0.0025, ELEMEDGE=0.110, KN={0, 25};
FIRST_DRIFT_2 : DRIFT    , L=0.025, ELEMEDGE=0.113;
DEFOCUS_POLE_2: MULTIPOLE, L=0.0025, ELEMEDGE=0.138, KN={0, -25};
SECOND_DRIFT_2: DRIFT    , L=0.025, ELEMEDGE=0.140;

FOCUS_POLE_3  : MULTIPOLE, L=0.0025, ELEMEDGE=0.165, KN={0, 25};
FIRST_DRIFT_3 : DRIFT    , L=0.025, ELEMEDGE=0.168;
DEFOCUS_POLE_3: MULTIPOLE, L=0.0025, ELEMEDGE=0.193, KN={0, -25};
SECOND_DRIFT_3: DRIFT    , L=0.025, ELEMEDGE=0.195;

FOCUS_POLE_4  : MULTIPOLE, L=0.0025, ELEMEDGE=0.220, KN={0, 25};
FIRST_DRIFT_4 : DRIFT    , L=0.025, ELEMEDGE=0.223;
DEFOCUS_POLE_4: MULTIPOLE, L=0.0025, ELEMEDGE=0.247, KN={0, -25};
SECOND_DRIFT_4: DRIFT    , L=0.025, ELEMEDGE=0.250;

FOCUS_POLE_5  : MULTIPOLE, L=0.0025, ELEMEDGE=0.275, KN={0, 25};
FIRST_DRIFT_5 : DRIFT    , L=0.025, ELEMEDGE=0.278;
DEFOCUS_POLE_5: MULTIPOLE, L=0.0025, ELEMEDGE=0.303, KN={0, -25};
SECOND_DRIFT_5: DRIFT    , L=0.025, ELEMEDGE=0.305;

FOCUS_POLE_6  : MULTIPOLE, L=0.0025, ELEMEDGE=0.330, KN={0, 25};
FIRST_DRIFT_6 : DRIFT    , L=0.025, ELEMEDGE=0.333;
DEFOCUS_POLE_6: MULTIPOLE, L=0.0025, ELEMEDGE=0.358, KN={0, -25};
SECOND_DRIFT_6: DRIFT    , L=0.025, ELEMEDGE=0.360;

FOCUS_POLE_7  : MULTIPOLE, L=0.0025, ELEMEDGE=0.385, KN={0, 25};
FIRST_DRIFT_7 : DRIFT    , L=0.025, ELEMEDGE=0.388;
DEFOCUS_POLE_7: MULTIPOLE, L=0.0025, ELEMEDGE=0.413, KN={0, -25};
SECOND_DRIFT_7: DRIFT    , L=0.025, ELEMEDGE=0.415;

FOCUS_POLE_8  : MULTIPOLE, L=0.0025, ELEMEDGE=0.440, KN={0, 25};
FIRST_DRIFT_8 : DRIFT    , L=0.025, ELEMEDGE=0.443;
DEFOCUS_POLE_8: MULTIPOLE, L=0.0025, ELEMEDGE=0.468, KN={0, -25};
SECOND_DRIFT_8: DRIFT    , L=0.025, ELEMEDGE=0.470;

FOCUS_POLE_9  : MULTIPOLE, L=0.0025, ELEMEDGE=0.495, KN={0, 25};
FIRST_DRIFT_9 : DRIFT    , L=0.025, ELEMEDGE=0.497;
DEFOCUS_POLE_9: MULTIPOLE, L=0.0025, ELEMEDGE=0.522, KN={0, -25};
SECOND_DRIFT_9: DRIFT    , L=0.025, ELEMEDGE=0.525;

FOCUS_POLE_10  : MULTIPOLE, L=0.0025, ELEMEDGE=0.550, KN={0, 25};
FIRST_DRIFT_10 : DRIFT    , L=0.025, ELEMEDGE=0.552;
DEFOCUS_POLE_10: MULTIPOLE, L=0.0025, ELEMEDGE=0.578, KN={0, -25};
SECOND_DRIFT_10: DRIFT    , L=0.025, ELEMEDGE=0.580;

FOCUS_POLE_11  : MULTIPOLE, L=0.0025, ELEMEDGE=0.605, KN={0, 25};
FIRST_DRIFT_11 : DRIFT    , L=0.025, ELEMEDGE=0.607;
DEFOCUS_POLE_11: MULTIPOLE, L=0.0025, ELEMEDGE=0.632, KN={0, -25};
SECOND_DRIFT_11: DRIFT    , L=0.025, ELEMEDGE=0.635;

FOCUS_POLE_12  : MULTIPOLE, L=0.0025, ELEMEDGE=0.660, KN={0, 25};
FIRST_DRIFT_12 : DRIFT    , L=0.025, ELEMEDGE=0.662;
DEFOCUS_POLE_12: MULTIPOLE, L=0.0025, ELEMEDGE=0.688, KN={0, -25};
SECOND_DRIFT_12: DRIFT    , L=0.025, ELEMEDGE=0.690;

FOCUS_POLE_13  : MULTIPOLE, L=0.0025, ELEMEDGE=0.715, KN={0, 25};
FIRST_DRIFT_13 : DRIFT    , L=0.025, ELEMEDGE=0.717;
DEFOCUS_POLE_13: MULTIPOLE, L=0.0025, ELEMEDGE=0.742, KN={0, -25};
SECOND_DRIFT_13: DRIFT    , L=0.025, ELEMEDGE=0.745;

FOCUS_POLE_14  : MULTIPOLE, L=0.0025, ELEMEDGE=0.770, KN={0, 25};
FIRST_DRIFT_14 : DRIFT    , L=0.025, ELEMEDGE=0.772;
DEFOCUS_POLE_14: MULTIPOLE, L=0.0025, ELEMEDGE=0.797, KN={0, -25};
SECOND_DRIFT_14: DRIFT    , L=0.025, ELEMEDGE=0.800;

FOCUS_POLE_15  : MULTIPOLE, L=0.0025, ELEMEDGE=0.825, KN={0, 25};
FIRST_DRIFT_15 : DRIFT    , L=0.025, ELEMEDGE=0.827;
DEFOCUS_POLE_15: MULTIPOLE, L=0.0025, ELEMEDGE=0.852, KN={0, -25};
SECOND_DRIFT_15: DRIFT    , L=0.025, ELEMEDGE=0.855;

FOCUS_POLE_16  : MULTIPOLE, L=0.0025, ELEMEDGE=0.880, KN={0, 25};
FIRST_DRIFT_16 : DRIFT    , L=0.025, ELEMEDGE=0.882;
DEFOCUS_POLE_16: MULTIPOLE, L=0.0025, ELEMEDGE=0.907, KN={0, -25};
SECOND_DRIFT_16: DRIFT    , L=0.025, ELEMEDGE=0.910;

FOCUS_POLE_17  : MULTIPOLE, L=0.0025, ELEMEDGE=0.935, KN={0, 25};
FIRST_DRIFT_17 : DRIFT    , L=0.025, ELEMEDGE=0.938;
DEFOCUS_POLE_17: MULTIPOLE, L=0.0025, ELEMEDGE=0.963, KN={0, -25};
SECOND_DRIFT_17: DRIFT    , L=0.025, ELEMEDGE=0.965;

FOCUS_POLE_18  : MULTIPOLE, L=0.0025, ELEMEDGE=0.990, KN={0, 25};
FIRST_DRIFT_18 : DRIFT    , L=0.025, ELEMEDGE=0.992;
DEFOCUS_POLE_18: MULTIPOLE, L=0.0025, ELEMEDGE=1.017, KN={0, -25};
SECOND_DRIFT_18: DRIFT    , L=0.025, ELEMEDGE=1.020;

FOCUS_POLE_19  : MULTIPOLE, L=0.0025, ELEMEDGE=1.045, KN={0, 25};
FIRST_DRIFT_19 : DRIFT    , L=0.025, ELEMEDGE=1.047;
DEFOCUS_POLE_19: MULTIPOLE, L=0.0025, ELEMEDGE=1.072, KN={0, -25};
SECOND_DRIFT_19: DRIFT    , L=0.025, ELEMEDGE=1.075;

FOCUS_POLE_20  : MULTIPOLE, L=0.0025, ELEMEDGE=1.100, KN={0, 25};
FIRST_DRIFT_20 : DRIFT    , L=0.025, ELEMEDGE=1.103;
DEFOCUS_POLE_20: MULTIPOLE, L=0.0025, ELEMEDGE=1.127, KN={0, -25};
SECOND_DRIFT_20: DRIFT    , L=0.025, ELEMEDGE=1.130;

FOCUS_POLE_21  : MULTIPOLE, L=0.0025, ELEMEDGE=1.155, KN={0, 25};
FIRST_DRIFT_21 : DRIFT    , L=0.025, ELEMEDGE=1.157;
DEFOCUS_POLE_21: MULTIPOLE, L=0.0025, ELEMEDGE=1.182, KN={0, -25};
SECOND_DRIFT_21: DRIFT    , L=0.025, ELEMEDGE=1.185;

FOCUS_POLE_22  : MULTIPOLE, L=0.0025, ELEMEDGE=1.210, KN={0, 25};
FIRST_DRIFT_22 : DRIFT    , L=0.025, ELEMEDGE=1.212;
DEFOCUS_POLE_22: MULTIPOLE, L=0.0025, ELEMEDGE=1.237, KN={0, -25};
SECOND_DRIFT_22: DRIFT    , L=0.025, ELEMEDGE=1.240;

FOCUS_POLE_23  : MULTIPOLE, L=0.0025, ELEMEDGE=1.265, KN={0, 25};
FIRST_DRIFT_23 : DRIFT    , L=0.025, ELEMEDGE=1.267;
DEFOCUS_POLE_23: MULTIPOLE, L=0.0025, ELEMEDGE=1.292, KN={0, -25};
SECOND_DRIFT_23: DRIFT    , L=0.025, ELEMEDGE=1.295;

FOCUS_POLE_24  : MULTIPOLE, L=0.0025, ELEMEDGE=1.320, KN={0, 25};
FIRST_DRIFT_24 : DRIFT    , L=0.025, ELEMEDGE=1.323;
DEFOCUS_POLE_24: MULTIPOLE, L=0.0025, ELEMEDGE=1.347, KN={0, -25};
SECOND_DRIFT_24: DRIFT    , L=0.025, ELEMEDGE=1.350;

FOCUS_POLE_25  : MULTIPOLE, L=0.0025, ELEMEDGE=1.375, KN={0, 25};
FIRST_DRIFT_25 : DRIFT    , L=0.025, ELEMEDGE=1.377;
DEFOCUS_POLE_25: MULTIPOLE, L=0.0025, ELEMEDGE=1.402, KN={0, -25};
SECOND_DRIFT_25: DRIFT    , L=0.025, ELEMEDGE=1.405;

FOCUS_POLE_26  : MULTIPOLE, L=0.0025, ELEMEDGE=1.430, KN={0, 25};
FIRST_DRIFT_26 : DRIFT    , L=0.025, ELEMEDGE=1.432;
DEFOCUS_POLE_26: MULTIPOLE, L=0.0025, ELEMEDGE=1.457, KN={0, -25};
SECOND_DRIFT_26: DRIFT    , L=0.025, ELEMEDGE=1.460;

FOCUS_POLE_27  : MULTIPOLE, L=0.0025, ELEMEDGE=1.485, KN={0, 25};
FIRST_DRIFT_27 : DRIFT    , L=0.025, ELEMEDGE=1.488;
DEFOCUS_POLE_27: MULTIPOLE, L=0.0025, ELEMEDGE=1.512, KN={0, -25};
SECOND_DRIFT_27: DRIFT    , L=0.025, ELEMEDGE=1.515;

FOCUS_POLE_28  : MULTIPOLE, L=0.0025, ELEMEDGE=1.540, KN={0, 25};
FIRST_DRIFT_28 : DRIFT    , L=0.025, ELEMEDGE=1.542;
DEFOCUS_POLE_28: MULTIPOLE, L=0.0025, ELEMEDGE=1.567, KN={0, -25};
SECOND_DRIFT_28: DRIFT    , L=0.025, ELEMEDGE=1.570;

FOCUS_POLE_29  : MULTIPOLE, L=0.0025, ELEMEDGE=1.595, KN={0, 25};
FIRST_DRIFT_29 : DRIFT    , L=0.025, ELEMEDGE=1.597;
DEFOCUS_POLE_29: MULTIPOLE, L=0.0025, ELEMEDGE=1.622, KN={0, -25};
SECOND_DRIFT_29: DRIFT    , L=0.025, ELEMEDGE=1.625;

FOCUS_POLE_30  : MULTIPOLE, L=0.0025, ELEMEDGE=1.650, KN={0, 25};
FIRST_DRIFT_30 : DRIFT    , L=0.025, ELEMEDGE=1.652;
DEFOCUS_POLE_30: MULTIPOLE, L=0.0025, ELEMEDGE=1.677, KN={0, -25};
SECOND_DRIFT_30: DRIFT    , L=0.025, ELEMEDGE=1.680;

FOCUS_POLE_31  : MULTIPOLE, L=0.0025, ELEMEDGE=1.705, KN={0, 25};
FIRST_DRIFT_31 : DRIFT    , L=0.025, ELEMEDGE=1.708;
DEFOCUS_POLE_31: MULTIPOLE, L=0.0025, ELEMEDGE=1.732, KN={0, -25};
SECOND_DRIFT_31: DRIFT    , L=0.025, ELEMEDGE=1.735;

FOCUS_POLE_32  : MULTIPOLE, L=0.0025, ELEMEDGE=1.760, KN={0, 25};
FIRST_DRIFT_32 : DRIFT    , L=0.025, ELEMEDGE=1.762;
DEFOCUS_POLE_32: MULTIPOLE, L=0.0025, ELEMEDGE=1.787, KN={0, -25};
SECOND_DRIFT_32: DRIFT    , L=0.025, ELEMEDGE=1.790;

FOCUS_POLE_33  : MULTIPOLE, L=0.0025, ELEMEDGE=1.815, KN={0, 25};
FIRST_DRIFT_33 : DRIFT    , L=0.025, ELEMEDGE=1.817;
DEFOCUS_POLE_33: MULTIPOLE, L=0.0025, ELEMEDGE=1.842, KN={0, -25};
SECOND_DRIFT_33: DRIFT    , L=0.025, ELEMEDGE=1.845;

FOCUS_POLE_34  : MULTIPOLE, L=0.0025, ELEMEDGE=1.870, KN={0, 25};
FIRST_DRIFT_34 : DRIFT    , L=0.025, ELEMEDGE=1.873;
DEFOCUS_POLE_34: MULTIPOLE, L=0.0025, ELEMEDGE=1.897, KN={0, -25};
SECOND_DRIFT_34: DRIFT    , L=0.025, ELEMEDGE=1.900;

FOCUS_POLE_35  : MULTIPOLE, L=0.0025, ELEMEDGE=1.925, KN={0, 25};
FIRST_DRIFT_35 : DRIFT    , L=0.025, ELEMEDGE=1.927;
DEFOCUS_POLE_35: MULTIPOLE, L=0.0025, ELEMEDGE=1.952, KN={0, -25};
SECOND_DRIFT_35: DRIFT    , L=0.025, ELEMEDGE=1.955;

FOCUS_POLE_36  : MULTIPOLE, L=0.0025, ELEMEDGE=1.980, KN={0, 25};
FIRST_DRIFT_36 : DRIFT    , L=0.025, ELEMEDGE=1.982;
DEFOCUS_POLE_36: MULTIPOLE, L=0.0025, ELEMEDGE=2.007, KN={0, -25};
SECOND_DRIFT_36: DRIFT    , L=0.025, ELEMEDGE=2.010;

FOCUS_POLE_37  : MULTIPOLE, L=0.0025, ELEMEDGE=2.035, KN={0, 25};
FIRST_DRIFT_37 : DRIFT    , L=0.025, ELEMEDGE=2.038;
DEFOCUS_POLE_37: MULTIPOLE, L=0.0025, ELEMEDGE=2.062, KN={0, -25};
SECOND_DRIFT_37: DRIFT    , L=0.025, ELEMEDGE=2.065;

FOCUS_POLE_38  : MULTIPOLE, L=0.0025, ELEMEDGE=2.090, KN={0, 25};
FIRST_DRIFT_38 : DRIFT    , L=0.025, ELEMEDGE=2.092;
DEFOCUS_POLE_38: MULTIPOLE, L=0.0025, ELEMEDGE=2.117, KN={0, -25};
SECOND_DRIFT_38: DRIFT    , L=0.025, ELEMEDGE=2.120;

FOCUS_POLE_39  : MULTIPOLE, L=0.0025, ELEMEDGE=2.145, KN={0, 25};
FIRST_DRIFT_39 : DRIFT    , L=0.025, ELEMEDGE=2.147;
DEFOCUS_POLE_39: MULTIPOLE, L=0.0025, ELEMEDGE=2.172, KN={0, -25};
SECOND_DRIFT_39: DRIFT    , L=0.025, ELEMEDGE=2.175;

FOCUS_POLE_40  : MULTIPOLE, L=0.0025, ELEMEDGE=2.200, KN={0, 25};
FIRST_DRIFT_40 : DRIFT    , L=0.025, ELEMEDGE=2.203;
DEFOCUS_POLE_40: MULTIPOLE, L=0.0025, ELEMEDGE=2.228, KN={0, -25};
SECOND_DRIFT_40: DRIFT    , L=0.025, ELEMEDGE=2.230;

FOCUS_POLE_41  : MULTIPOLE, L=0.0025, ELEMEDGE=2.255, KN={0, 25};
FIRST_DRIFT_41 : DRIFT    , L=0.025, ELEMEDGE=2.257;
DEFOCUS_POLE_41: MULTIPOLE, L=0.0025, ELEMEDGE=2.282, KN={0, -25};
SECOND_DRIFT_41: DRIFT    , L=0.025, ELEMEDGE=2.285;

FOCUS_POLE_42  : MULTIPOLE, L=0.0025, ELEMEDGE=2.310, KN={0, 25};
FIRST_DRIFT_42 : DRIFT    , L=0.025, ELEMEDGE=2.312;
DEFOCUS_POLE_42: MULTIPOLE, L=0.0025, ELEMEDGE=2.337, KN={0, -25};
SECOND_DRIFT_42: DRIFT    , L=0.025, ELEMEDGE=2.340;

FOCUS_POLE_43  : MULTIPOLE, L=0.0025, ELEMEDGE=2.365, KN={0, 25};
FIRST_DRIFT_43 : DRIFT    , L=0.025, ELEMEDGE=2.368;
DEFOCUS_POLE_43: MULTIPOLE, L=0.0025, ELEMEDGE=2.393, KN={0, -25};
SECOND_DRIFT_43: DRIFT    , L=0.025, ELEMEDGE=2.395;

FOCUS_POLE_44  : MULTIPOLE, L=0.0025, ELEMEDGE=2.420, KN={0, 25};
FIRST_DRIFT_44 : DRIFT    , L=0.025, ELEMEDGE=2.422;
DEFOCUS_POLE_44: MULTIPOLE, L=0.0025, ELEMEDGE=2.447, KN={0, -25};
SECOND_DRIFT_44: DRIFT    , L=0.025, ELEMEDGE=2.450;

FOCUS_POLE_45  : MULTIPOLE, L=0.0025, ELEMEDGE=2.475, KN={0, 25};
FIRST_DRIFT_45 : DRIFT    , L=0.025, ELEMEDGE=2.478;
DEFOCUS_POLE_45: MULTIPOLE, L=0.0025, ELEMEDGE=2.502, KN={0, -25};
SECOND_DRIFT_45: DRIFT    , L=0.025, ELEMEDGE=2.505;

FOCUS_POLE_46  : MULTIPOLE, L=0.0025, ELEMEDGE=2.530, KN={0, 25};
FIRST_DRIFT_46 : DRIFT    , L=0.025, ELEMEDGE=2.532;
DEFOCUS_POLE_46: MULTIPOLE, L=0.0025, ELEMEDGE=2.557, KN={0, -25};
SECOND_DRIFT_46: DRIFT    , L=0.025, ELEMEDGE=2.560;

FOCUS_POLE_47  : MULTIPOLE, L=0.0025, ELEMEDGE=2.585, KN={0, 25};
FIRST_DRIFT_47 : DRIFT    , L=0.025, ELEMEDGE=2.587;
DEFOCUS_POLE_47: MULTIPOLE, L=0.0025, ELEMEDGE=2.612, KN={0, -25};
SECOND_DRIFT_47: DRIFT    , L=0.025, ELEMEDGE=2.615;

FOCUS_POLE_48  : MULTIPOLE, L=0.0025, ELEMEDGE=2.640, KN={0, 25};
FIRST_DRIFT_48 : DRIFT    , L=0.025, ELEMEDGE=2.643;
DEFOCUS_POLE_48: MULTIPOLE, L=0.0025, ELEMEDGE=2.667, KN={0, -25};
SECOND_DRIFT_48: DRIFT    , L=0.025, ELEMEDGE=2.670;

FOCUS_POLE_49  : MULTIPOLE, L=0.0025, ELEMEDGE=2.695, KN={0, 25};
FIRST_DRIFT_49 : DRIFT    , L=0.025, ELEMEDGE=2.697;
DEFOCUS_POLE_49: MULTIPOLE, L=0.0025, ELEMEDGE=2.722, KN={0, -25};
SECOND_DRIFT_49: DRIFT    , L=0.025, ELEMEDGE=2.725;

SOLine: Line = (FOCUS_POLE_0, FIRST_DRIFT_0, DEFOCUS_POLE_0, SECOND_DRIFT_0,
FOCUS_POLE_1, FIRST_DRIFT_1, DEFOCUS_POLE_1, SECOND_DRIFT_1,
FOCUS_POLE_2, FIRST_DRIFT_2, DEFOCUS_POLE_2, SECOND_DRIFT_2,
FOCUS_POLE_3, FIRST_DRIFT_3, DEFOCUS_POLE_3, SECOND_DRIFT_3,
FOCUS_POLE_4, FIRST_DRIFT_4, DEFOCUS_POLE_4, SECOND_DRIFT_4,
FOCUS_POLE_5, FIRST_DRIFT_5, DEFOCUS_POLE_5, SECOND_DRIFT_5,
FOCUS_POLE_6, FIRST_DRIFT_6, DEFOCUS_POLE_6, SECOND_DRIFT_6,
FOCUS_POLE_7, FIRST_DRIFT_7, DEFOCUS_POLE_7, SECOND_DRIFT_7,
FOCUS_POLE_8, FIRST_DRIFT_8, DEFOCUS_POLE_8, SECOND_DRIFT_8,
FOCUS_POLE_9, FIRST_DRIFT_9, DEFOCUS_POLE_9, SECOND_DRIFT_9,
FOCUS_POLE_10, FIRST_DRIFT_10, DEFOCUS_POLE_10, SECOND_DRIFT_10,
FOCUS_POLE_11, FIRST_DRIFT_11, DEFOCUS_POLE_11, SECOND_DRIFT_11,
FOCUS_POLE_12, FIRST_DRIFT_12, DEFOCUS_POLE_12, SECOND_DRIFT_12,
FOCUS_POLE_13, FIRST_DRIFT_13, DEFOCUS_POLE_13, SECOND_DRIFT_13,
FOCUS_POLE_14, FIRST_DRIFT_14, DEFOCUS_POLE_14, SECOND_DRIFT_14,
FOCUS_POLE_15, FIRST_DRIFT_15, DEFOCUS_POLE_15, SECOND_DRIFT_15,
FOCUS_POLE_16, FIRST_DRIFT_16, DEFOCUS_POLE_16, SECOND_DRIFT_16,
FOCUS_POLE_17, FIRST_DRIFT_17, DEFOCUS_POLE_17, SECOND_DRIFT_17,
FOCUS_POLE_18, FIRST_DRIFT_18, DEFOCUS_POLE_18, SECOND_DRIFT_18,
FOCUS_POLE_19, FIRST_DRIFT_19, DEFOCUS_POLE_19, SECOND_DRIFT_19,
FOCUS_POLE_20, FIRST_DRIFT_20, DEFOCUS_POLE_20, SECOND_DRIFT_20,
FOCUS_POLE_21, FIRST_DRIFT_21, DEFOCUS_POLE_21, SECOND_DRIFT_21,
FOCUS_POLE_22, FIRST_DRIFT_22, DEFOCUS_POLE_22, SECOND_DRIFT_22,
FOCUS_POLE_23, FIRST_DRIFT_23, DEFOCUS_POLE_23, SECOND_DRIFT_23,
FOCUS_POLE_24, FIRST_DRIFT_24, DEFOCUS_POLE_24, SECOND_DRIFT_24,
FOCUS_POLE_25, FIRST_DRIFT_25, DEFOCUS_POLE_25, SECOND_DRIFT_25,
FOCUS_POLE_26, FIRST_DRIFT_26, DEFOCUS_POLE_26, SECOND_DRIFT_26,
FOCUS_POLE_27, FIRST_DRIFT_27, DEFOCUS_POLE_27, SECOND_DRIFT_27,
FOCUS_POLE_28, FIRST_DRIFT_28, DEFOCUS_POLE_28, SECOND_DRIFT_28,
FOCUS_POLE_29, FIRST_DRIFT_29, DEFOCUS_POLE_29, SECOND_DRIFT_29,
FOCUS_POLE_30, FIRST_DRIFT_30, DEFOCUS_POLE_30, SECOND_DRIFT_30,
FOCUS_POLE_31, FIRST_DRIFT_31, DEFOCUS_POLE_31, SECOND_DRIFT_31,
FOCUS_POLE_32, FIRST_DRIFT_32, DEFOCUS_POLE_32, SECOND_DRIFT_32,
FOCUS_POLE_33, FIRST_DRIFT_33, DEFOCUS_POLE_33, SECOND_DRIFT_33,
FOCUS_POLE_34, FIRST_DRIFT_34, DEFOCUS_POLE_34, SECOND_DRIFT_34,
FOCUS_POLE_35, FIRST_DRIFT_35, DEFOCUS_POLE_35, SECOND_DRIFT_35,
FOCUS_POLE_36, FIRST_DRIFT_36, DEFOCUS_POLE_36, SECOND_DRIFT_36,
FOCUS_POLE_37, FIRST_DRIFT_37, DEFOCUS_POLE_37, SECOND_DRIFT_37,
FOCUS_POLE_38, FIRST_DRIFT_38, DEFOCUS_POLE_38, SECOND_DRIFT_38,
FOCUS_POLE_39, FIRST_DRIFT_39, DEFOCUS_POLE_39, SECOND_DRIFT_39,
FOCUS_POLE_40, FIRST_DRIFT_40, DEFOCUS_POLE_40, SECOND_DRIFT_40,
FOCUS_POLE_41, FIRST_DRIFT_41, DEFOCUS_POLE_41, SECOND_DRIFT_41,
FOCUS_POLE_42, FIRST_DRIFT_42, DEFOCUS_POLE_42, SECOND_DRIFT_42,
FOCUS_POLE_43, FIRST_DRIFT_43, DEFOCUS_POLE_43, SECOND_DRIFT_43,
FOCUS_POLE_44, FIRST_DRIFT_44, DEFOCUS_POLE_44, SECOND_DRIFT_44,
FOCUS_POLE_45, FIRST_DRIFT_45, DEFOCUS_POLE_45, SECOND_DRIFT_45,
FOCUS_POLE_46, FIRST_DRIFT_46, DEFOCUS_POLE_46, SECOND_DRIFT_46,
FOCUS_POLE_47, FIRST_DRIFT_47, DEFOCUS_POLE_47, SECOND_DRIFT_47,
FOCUS_POLE_48, FIRST_DRIFT_48, DEFOCUS_POLE_48, SECOND_DRIFT_48,
FOCUS_POLE_49, FIRST_DRIFT_49, DEFOCUS_POLE_49, SECOND_DRIFT_49
);

Dist: DISTRIBUTION, TYPE = GAUSS,
        SIGMAX = 0.001,
        SIGMAY = 0.001,
	SIGMAZ = 0.001;

//----------------------------------------------------------------------------
// Define Field solvers
// The mesh sizes should be a factor of 2
// for most efficient space charge calculation.

FS_SC: Fieldsolver, TYPE = NONE,
            NX = 16, NY = 16, NZ = 16, // SC grid size is 32^3
            PARFFTX = false,
            PARFFTY = false,
            PARFFTZ = true,  // parallel in the z direction only
            BCFFTX = open,
            BCFFTY = open,
            BCFFTZ = open,
            BBOXINCR = 1,
            GREENSF = INTEGRATED;

//----------------------------------------------------------------------------
// Electron Beam Definition

BEAM1:  BEAM, PARTICLE = ELECTRON, pc = P0, NPART = n_particles,
        BFREQ = rf_freq, BCURRENT = beam_bunch_charge * rf_freq * 1e6, CHARGE = -1;

//----------------------------------------------------------------------------
// Simulate the beamline using TRACK and RUN.
// Note, different time steps are set based on the z location in the beam line.
// In the case below, 1.0e-13 is used for 0.0 to 0.4 m,
// and 3.0e-12 is used from 0.4 to 5 m.

TRACK, LINE = SOLine, BEAM = BEAM1, MAXSTEPS = 13925, DT = 7e-13;
RUN, METHOD = "PARALLEL", BEAM = BEAM1,
    FIELDSOLVER = FS_SC, DISTRIBUTION = Dist;
ENDTRACK;
Quit;
